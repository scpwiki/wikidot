# -- UTILITY

update:cmd: npm run lerna:clean && npm run bootstrap && npm run build
update: npm i && ultra --raw update:cmd
bootstrap: lerna bootstrap --hoist --loglevel success
lerna:clean: lerna clean --yes --loglevel success

# -- BUILD

build: ultra --rebuild -r build

# -- TESTING

test:compile:
  - trash tests-dist
  - node scripts/build-tests.js
test:run: uvu ./tests-dist/dist test-megabundle.+js$
test: npm run test:compile && nyc npm run test:run

# -- VALIDATION

typecheck: tsc

lint:
  eslint: eslint "./**/*.js" "./**/*.ts"
  stylelint: stylelint "modules/**/*.scss" "web/**/*.css"
  prettier: prettier --check "modules/" "web/"

lint:fix:
  eslint: eslint "./**/*.js" "./**/*.ts" --fix
  stylelint: stylelint "modules/**/*.scss" "web/**/*.css" --fix
  prettier: prettier --write "modules/" "web/"

# Runs everything in parallel for maximum speed
validate:cmd: npm run lint && npm run typecheck
validate: ultra --concurrency 10 validate:cmd

# -- MISC.

dev:dev-sandbox: ultra --raw -r --filter "web/dev-sandbox" dev
