# Stub components

This directory contains:

- Svelte components that consume stub components.
- Specifications for stub components.
- Meta-specification for stub component specifications (`stubs.schema.yaml`).

Stub components are snippets of HTML that contain information that would 
normally be interactive, but in a non-interactive form. Stub components are 
generated by Wikijump's backend and by FTML's HTML renderer, and sent to 
the browser, whereupon the frontend replaces it with a reactive Svelte 
component (also referred to as a 'full component').

This serves two purposes:

- It simplifies the payload from the backend, as it does not have to 
  implement reactivity; it can leave that job to the frontend.
- Users without JavaScript are able to see all contents of the component, 
  facilitating the most common use case of the site: non-interactive 
  reading. These users should not _need_ to have JavaScript in order to 
  engage with the site in a non-interactive way.

For example, a tabview would normally need JavaScript to navigate, with the 
user clicking on each tab to reveal its contents. For a user without 
JavaScript, the contents of these tabs would never be visible.

Therefore, stub components are designed not only to contain the data needed 
for the frontend to later implement reactivity on it, but also to be 
formatted in a way that it is possible for the user to consume its contents.
This means that all text

## Requirements

A stub component must fulfill three requirements, in decreasing order of 
priority:

1. The stub component must contain the data needed to construct the full 
   component.
2. The stub component must be entirely legible by itself, even without any 
   changes from the frontend. It must expose all information that would 
   normally be readable to the user, even if some of that information would 
   normally be hidden initially. It should be contextually similar, e.g. it 
   should visually look roughly the same, and have the information 
   presented in a similar order if possible.
3. The stub component should simplify the workload of the backend. The 
   backend should be able to deliver a simple component; any additional 
   complexity can be added by the frontend. Frequent changes to the full 
   component should only effect minimal changes to the stub component.

## Creating stub components

A spec for the stub component should be defined in a `[component].stub.yaml`
file. It should comply with the schema &mdash; there should be some way to 
configure your editor to validate this automatically.

The full component should be written to consume the stub component, and 
there should be tests to verify this works correctly.

The part of the backend that produces the stub component &mdash; whether 
Laravel or FTML &mdash; should ensure that the output matches the spec.

Data that does not need to be visible to the user, e.g. settings, can be 
exposed via `data-` attributes.

The full component does not need to have the same HTML structure as the 
stub component, however care should be taken to ensure that the two are 
visually compatible. CSS classes with contextual styling should be shared 
between the two components, for example.
